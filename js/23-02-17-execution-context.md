# 실행 컨텍스트

## 소스코드의 타입
- 전역 코드 
- 함수 코드 
- eval 코드 
- 모듈 코드 

각각의 소드코드 타입별로 소스코드를 평가하여 각각의 실행 컨텍스트를 생성한다.

<br/>

## 소스코드의 평가와 실행
### 소스코드 평가
실행 컨텍스트를 생성하고 변수, 함수 등의 선언문만 먼저 실행하여 생성된 변수나 함수 식별자를 실행 컨텍스트가 관리하는 스코프에 등록한다.

```js
var x;
// 1. 소스코드 평가 : var x를 실행한다.
// 2. 변수 식별자 x는 실행 컨텍스트가 관리하는 스코프에 등록되고 undefined로 초기화된다. 
```

### 소스코드의 실행 
선언문을 제외한 소스코드가 순차적으로 실행한다. 즉 런타임이 실행된다. 이때 소스코드 실행에 필요한 정보들은 실행 컨텍스트가 관리하는 스코프에서 검색하여 취득한다. 그 후 변수 값의 변경 등 소스코드의 실행 결과는 다시 실행 컨텍스트가 관리하는 스코프에 등록된다.

```js
x = 1;
// 3. 소스코드 실행 : 스코프에 x 변수가 등록되어 있는지 확인한다.
// 4. 실행 컨텍스트가 관리하는 스코프에 등록되어 있다면 값을 할당하고 할당 결과를 실행 컨텍스트에 등록하여 관리한다.
```

<br/>

## 실행 컨텍스트 스택
```js
const x = 1;

function foo(){
  const y = 2;

  function bar(){
    const z = 3;
    console.log(x+y+z);
  }
  bar();
}

foo(); // 6
```
자바스크립트 엔진은 먼저 전역 코드를 평가하여 전역 실행 컨텍스트를 생성한다. 그리고 함수가 호출되면 함수 코드를 평가하여 함수 실행 컨텍스트를 생성한다. 이때 생성된 컨텍스트는 스택 자료구조로 관리된다. 이를 실행 컨텍스트 스택이라고 한다.

#### 실행 컨텍스트는 추가되고 제거된다. 실행 컨텍스트 스택에 최상위에 존재하는 실행 컨텍스트는 언제나 현재 실행 중인 코드의 실행 컨텍스트이다.

<img src="../img/23-5. 실행 컨텍스트 스택.png"/>



<br/>

## 렉시컬 환경
식별자와 식별자에 바인딩된 값, 상위 스코프에 대한 참조를 기록하는 자료구조로 실행 컨텍스트를 구성하는 컴포넌트이다. 실행 컨텍스트 스택이 코드의 실행 순서를 관리하고 렉시컬 환경은 키와 값을 갖는 객체 형태의 스코프를 생성하여 스코프를 구분하고 식별자를 관리한다. 
